const SHEETSMENU = {
    pescados:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=0&single=true&output=csv",
    carnes: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=837665956&single=true&output=csv",
    entradas:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1719864108&single=true&output=csv",
    ceviches:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1691195033&single=true&output=csv",
    vegetariano:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=317391562&single=true&output=csv",
    chupes: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=2025493624&single=true&output=csv",
    salsas: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=605623578&single=true&output=csv",
    agregados:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1186913897&single=true&output=csv",
    salsasverdes:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1716890737&single=true&output=csv",
    apanados:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=111747660&single=true&output=csv",
    parmesano:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=248340176&single=true&output=csv",
    alpilpil:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1202101954&single=true&output=csv",
    menukids:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=164206130&single=true&output=csv",
    sopa: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=2066021936&single=true&output=csv",
    especialidades:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1451717454&single=true&output=csv",
    cafeteria:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=316921012&single=true&output=csv",
    postres:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=261970413&single=true&output=csv",
    sunset: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRhT-0PjkNDVvPhfPm-e5-DMafbWvyugaenGg34b27nCy3JvziaR-mNOzILGcasgPpw0vTvl1DNaes_/pub?gid=1675168130&single=true&output=csv",
};

const SHEETSTRAGOS = {
    bebidas:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=0&single=true&output=csv",
    jugos: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=632555009&single=true&output=csv",
    energizante:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1094352542&single=true&output=csv",
    beernacional:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1838970905&single=true&output=csv",
    beerinternacional:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1620993039&single=true&output=csv",
    beersinalchol:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=13507593&single=true&output=csv",
    espumante:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1093991600&single=true&output=csv",
    aperitivos:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1153012802&single=true&output=csv",
    tequila:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=858673033&single=true&output=csv",
    tragos: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1984685360&single=true&output=csv",
    piscos: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=2077926672&single=true&output=csv",
    tololo: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1033494134&single=true&output=csv",
    castillomolina:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1401146374&single=true&output=csv",
    misionesrengo:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=2010453198&single=true&output=csv",
    grantarapaca:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1386550471&single=true&output=csv",
    leyenda:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1416467040&single=true&output=csv",
    sanpedro:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=960154989&single=true&output=csv",
    cavadominguez:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=970758938&single=true&output=csv",
    brandy: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=644340776&single=true&output=csv",
    whisky: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=2104508390&single=true&output=csv",
    ron: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1335690910&single=true&output=csv",
    vodka: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=1684246034&single=true&output=csv",
    gin: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=2024079801&single=true&output=csv",
    bajativos:
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2LS9iiBn0bie0bPnavTZzZp3uCIbfAZjj-KjbvjvyzveRtTN1mJUhDfqo1D6AFFhB7e2Ad78ORAD2/pub?gid=259290281&single=true&output=csv",
};

// FunciÃ³n para convertir CSV en JSON
const parseCSV = (csv: string) => {
    return csv
        .split("\n")
        .slice(1) // Quita encabezados
        .map((row) => {
            const match = row.match(/^(.*?),(.*?),\((.*?)\)$/);
            if (match) {
                const [, title, price, description] = match;
                return {
                    title: title?.replace(/^"|"$/g, "").trim(),
                    price: parseFloat(price),
                    description:
                        description?.replace(/^"|"$/g, "").trim() || "",
                };
            } else {
                const [title, price, ...descriptionParts] = row.split(",");
                const description = descriptionParts
                    .join(",")
                    .replace(/^"|"$/g, "")
                    .trim();
                return {
                    title: title?.replace(/^"|"$/g, "").trim(),
                    price: parseFloat(price),
                    description: description || "",
                };
            }
        })
        .filter((item) => item !== null);
};

export const getMenu = async () => {
    const data: Record<string, any[]> = {};

    await Promise.all(
        Object.entries(SHEETSMENU).map(async ([category, url]) => {
            const response = await fetch(url);
            const text = await response.text();
            data[category] = parseCSV(text);
        })
    );

    return JSON.stringify(data);
};

export const getTragos = async () => {
    const data: Record<string, any[]> = {};

    await Promise.all(
        Object.entries(SHEETSTRAGOS).map(async ([category, url]) => {
            const response = await fetch(url);
            const text = await response.text();
            data[category] = parseCSV(text);
        })
    );

    return JSON.stringify(data);
};
